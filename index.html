<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador Inmobiliario Century v2.0</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- CSS Responsivo -->
    <link rel="stylesheet" href="css/responsive.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Open Graph para compartir en redes sociales -->
    <meta property="og:title" content="Cotizador Inmobiliario Century 21">
    <meta property="og:description" content="Herramienta profesional de tasación inmobiliaria">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://example.com/century21-image.jpg">
</head>
<body>
    <header>
        <div class="container">
            <img src="assets/images/c21.png" alt="Logo Century 21" class="logo">
            <h1>Cotizador Inmobiliario Century21 V2.0</h1>
        <p>Herramienta profesional de tasación inmobiliaria</p>
        </div>
    </header>

    <div class="container">
        <!-- Indicador de progreso -->
        <div class="progress-indicator" role="tablist" aria-label="Pasos del cotizador">
            <div class="progress-step active" data-step="1" role="tab" aria-selected="true" aria-controls="step-1">
                <div class="step-number">1</div>
                <div class="step-label">Datos del Inmueble</div>
            </div>
            <div class="progress-step" data-step="2" role="tab" aria-selected="false" aria-controls="step-2">
                <div class="step-number">2</div>
                <div class="step-label">Comparables</div>
            </div>
            <div class="progress-step" data-step="3" role="tab" aria-selected="false" aria-controls="step-3">
                <div class="step-number">3</div>
                <div class="step-label">Factores de Ajuste</div>
            </div>
            <div class="progress-step" data-step="4" role="tab" aria-selected="false" aria-controls="step-4">
                <div class="step-number">4</div>
                <div class="step-label">Valor de Referencia</div>
            </div>
            <div class="progress-step" data-step="5" role="tab" aria-selected="false" aria-controls="step-5">
                <div class="step-number">5</div>
                <div class="step-label">Composición del Valor</div>
            </div>
        </div>

        <!-- Paso 1: Datos del Inmueble -->
        <section id="step-1" class="step-content active" role="tabpanel" aria-labelledby="step-1">
            <div class="step-header">
                <h2><i class="fas fa-building"></i> Datos del Inmueble a Tasar</h2>
                <p>Ingrese los datos objetivos del inmueble que será tasado</p>
            </div>
            
            <div class="form-container">
                <div class="form-row">
                    <div class="form-group">
                        <label for="tipo-propiedad">Tipo de Propiedad</label>
                        <select id="tipo-propiedad" required aria-required="true">
                            <option value="">Seleccionar...</option>
                            <option value="casa">Casa</option>
                            <option value="ph">PH</option>
                            <option value="departamento">Departamento</option>
                            <option value="duplex">Duplex</option>
                            <option value="triplex">Triplex</option>
                            <option value="loft">Loft</option>
                            <option value="terreno">Terreno</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="direccion">Dirección</label>
                        <input type="text" id="direccion" placeholder="Calle y número" required aria-required="true">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="piso">Piso</label>
                        <input type="text" id="piso" placeholder="Ej: PB, 1°, 2°, etc.">
                    </div>
                    <div class="form-group">
                        <label for="depto">Departamento</label>
                        <input type="text" id="depto" placeholder="Ej: A, B, 1, 2, etc.">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="localidad">Localidad</label>
                        <input type="text" id="localidad" placeholder="Ej: CABA, La Plata, etc." required aria-required="true">
                    </div>
                    <div class="form-group">
                        <label for="barrio">Barrio/Zona</label>
                        <input type="text" id="barrio" placeholder="Ej: Palermo, Belgrano, etc." required aria-required="true">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="antiguedad">Antigüedad (años)</label>
                        <input type="number" id="antiguedad" min="0" placeholder="Ej: 5" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <label for="calidad">Calidad de Construcción</label>
                        <select id="calidad" required aria-required="true">
                            <option value="">Seleccionar...</option>
                            <option value="excelente">Excelente</option>
                            <option value="muy-buena">Muy Buena</option>
                            <option value="buena">Buena</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="sup-cubierta">Superficie Cubierta (m²)</label>
                        <input type="number" id="sup-cubierta" min="0" step="0.01" placeholder="Ej: 85.50" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <label for="sup-semicubierta">Superficie Semicubierta (m²)</label>
                        <input type="number" id="sup-semicubierta" min="0" step="0.01" placeholder="Ej: 20.00">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="sup-descubierta">Superficie Descubierta (m²)</label>
                        <input type="number" id="sup-descubierta" min="0" step="0.01" placeholder="Ej: 30.00">
                    </div>
                    <div class="form-group">
                        <label for="sup-balcon">Superficie Balcón (m²)</label>
                        <input type="number" id="sup-balcon" min="0" step="0.01" placeholder="Ej: 5.00">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="sup-terreno">Superficie Total del Terreno (m²)</label>
                        <input type="number" id="sup-terreno" min="0" step="0.01" placeholder="Ej: 180.00">
                    </div>
                    <div class="form-group">
                        <label for="cochera">Cochera</label>
                        <select id="cochera">
                            <option value="no">No tiene</option>
                            <option value="propia">Propia</option>
                            <option value="comun">Común</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button id="btn-siguiente-1" class="btn-primary">Siguiente <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </section>

        <!-- Paso 2: Comparables -->
        <section id="step-2" class="step-content" role="tabpanel" aria-labelledby="step-2">
            <div class="step-header">
                <h2><i class="fas fa-chart-bar"></i> Comparables de Mercado</h2>
                <p>Agregue al menos 4 propiedades similares para comparar</p>
            </div>
            
            <div class="comparable-actions">
                <button id="btn-agregar-comparable" class="btn-primary"><i class="fas fa-plus"></i> Agregar Comparable</button>
                <div class="discount-control">
                    <label for="descuento-negociacion">Descuento de Negociación (%):</label>
                    <input type="number" id="descuento-negociacion" min="0" max="100" step="0.1" value="10">
                </div>
            </div>
            
            <div id="comparables-container" class="comparables-container">
                <!-- Los comparables se agregarán dinámicamente aquí -->
            </div>
            
            <div id="no-comparables" class="empty-state">
                <i class="fas fa-home"></i>
                <p>No hay comparables cargados</p>
                <p>Haga clic en "Agregar Comparable" para comenzar</p>
            </div>
            
            <div class="form-actions">
                <button id="btn-anterior-2" class="btn-secondary"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button id="btn-siguiente-2" class="btn-primary" disabled>Siguiente <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- Paso 3: Factores de Ajuste -->
        <section id="step-3" class="step-content" role="tabpanel" aria-labelledby="step-3">
            <div class="step-header">
                <h2><i class="fas fa-sliders-h"></i> Factores de Ajuste</h2>
                <p>Ajuste los comparables según características cualitativas</p>
            </div>
            
            <div class="factors-container">
                <div class="factor-tabs" role="tablist">
                    <button class="factor-tab active" data-comparable="1" role="tab" aria-selected="true" aria-controls="factors-comparable-1">Comparable 1</button>
                    <button class="factor-tab" data-comparable="2" role="tab" aria-selected="false" aria-controls="factors-comparable-2">Comparable 2</button>
                    <button class="factor-tab" data-comparable="3" role="tab" aria-selected="false" aria-controls="factors-comparable-3">Comparable 3</button>
                    <button class="factor-tab" data-comparable="4" role="tab" aria-selected="false" aria-controls="factors-comparable-4">Comparable 4</button>
                </div>
                
                <div id="factors-content" class="factors-content">
                    <!-- Los factores de ajuste se cargarán dinámicamente aquí -->
                </div>
            </div>
            
            <div class="form-actions">
                <button id="btn-anterior-3" class="btn-secondary"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button id="btn-siguiente-3" class="btn-primary">Siguiente <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- Paso 4: Valor de Referencia -->
        <section id="step-4" class="step-content" role="tabpanel" aria-labelledby="step-4">
            <div class="step-header">
                <h2><i class="fas fa-calculator"></i> Valor de Referencia</h2>
                <p>Valor por metro cuadrado calculado a partir de los comparables ajustados</p>
            </div>
            
            <div class="reference-value-container">
                <div class="reference-method">
                    <label for="metodo-calculo">Método de Cálculo:</label>
                    <select id="metodo-calculo">
                        <option value="promedio">Promedio Simple</option>
                        <option value="promedio-ponderado">Promedio Ponderado</option>
                        <option value="mediana">Mediana</option>
                    </select>
                </div>
                
                <div class="reference-result">
                    <div class="result-label">Valor por m² de Referencia</div>
                    <!-- CORRECCIÓN: Añadir data-raw-value para el test -->
                    <div class="result-value"><span id="valor-m2-referencia" data-raw-value="0">USD 0,00</span></div>
                </div>
                
                <div class="comparables-adjusted">
                    <h3>Valores Ajustados por m²</h3>
                    <div id="valores-ajustados-container">
                        <!-- Los valores ajustados se mostrarán aquí -->
                    </div>
                </div>
            </div>
            
            <div class="form-actions">
                <button id="btn-anterior-4" class="btn-secondary"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button id="btn-siguiente-4" class="btn-primary">Siguiente <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- Paso 5: Composición del Valor -->
        <section id="step-5" class="step-content" role="tabpanel" aria-labelledby="step-5">
            <div class="step-header">
                <h2><i class="fas fa-chart-pie"></i> Composición del Valor</h2>
                <p>Cálculo del valor total según composición de superficies</p>
            </div>
            
            <div class="composition-container">
                <div class="composition-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Tipo de Superficie</th>
                                <th>Superficie (m²)</th>
                                <th>Coeficiente</th>
                                <th>Valor por m²</th>
                                <th>Valor Parcial</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Cubierta</td>
                                <td id="comp-sup-cubierta">0</td>
                                <td>100%</td>
                                <td id="comp-valor-m2">$0.00</td>
                                <td id="comp-valor-cubierta">$0.00</td>
                            </tr>
                            <tr>
                                <td>Semicubierta</td>
                                <td id="comp-sup-semicubierta">0</td>
                                <td>50%</td>
                                <td id="comp-valor-m2-semi">$0.00</td>
                                <td id="comp-valor-semicubierta">$0.00</td>
                            </tr>
                            <tr>
                                <td>Descubierta</td>
                                <td id="comp-sup-descubierta">0</td>
                                <td>20%</td>
                                <td id="comp-valor-m2-desc">$0.00</td>
                                <td id="comp-valor-descubierta">$0.00</td>
                            </tr>
                            <tr>
                                <td>Balcón</td>
                                <td id="comp-sup-balcon">0</td>
                                <td>33%</td>
                                <td id="comp-valor-m2-balc">$0.00</td>
                                <td id="comp-valor-balcon">$0.00</td>
                            </tr>
                            <tr>
                                <td>Cochera</td>
                                <td id="comp-sup-cochera">-</td>
                                <td>Global</td>
                                <td id="comp-valor-m2-cochera">$0.00</td>
                                <td id="comp-valor-cochera">$0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="total-value">
                    <div class="total-label">TOTAL VALOR DE TASACIÓN</div>
                    <!-- CORRECCIÓN: Añadir data-raw-value para el test -->
                    <div class="total-amount"><span id="valor-total-tasacion" data-raw-value="0">USD 0,00</span></div>
                </div>
            </div>
            
            <div class="form-actions">
                <button id="btn-anterior-5" class="btn-secondary"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button id="btn-guardar-backend" class="btn-primary"><i class="fas fa-save"></i> Guardar en Servidor</button>
                <button id="btn-exportar" class="btn-primary"><i class="fas fa-file-pdf"></i> Exportar Informe</button>
                <button id="btn-reiniciar" class="btn-secondary"><i class="fas fa-redo"></i> Reiniciar</button>
            </div>
        </section>
    </div>

    <!-- Modal para agregar/editar comparables -->
    <div id="modal-comparable" class="modal" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Agregar Comparable</h3>
                <span class="close-modal" aria-label="Cerrar">&times;</span>
            </div>
            <div class="modal-body">
                <form id="form-comparable">
                    <input type="hidden" id="comparable-id">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-tipo-propiedad">Tipo de Propiedad</label>
                            <select id="comp-tipo-propiedad" required aria-required="true">
                                <option value="">Seleccionar...</option>
                                <option value="casa">Casa</option>
                                <option value="ph">PH</option>
                                <option value="departamento">Departamento</option>
                                <option value="duplex">Duplex</option>
                                <option value="triplex">Triplex</option>
                                <option value="loft">Loft</option>
                                <option value="terreno">Terreno</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="comp-precio">Precio de Venta (USD)</label>
                            <input type="number" id="comp-precio" min="0" step="0.01" required aria-required="true">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-direccion">Dirección</label>
                            <input type="text" id="comp-direccion" required aria-required="true">
                        </div>
                        <div class="form-group">
                            <label for="comp-numero">Número</label>
                            <input type="text" id="comp-numero">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-piso">Piso</label>
                            <input type="text" id="comp-piso">
                        </div>
                        <div class="form-group">
                            <label for="comp-depto">Departamento</label>
                            <input type="text" id="comp-depto">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-localidad">Localidad</label>
                            <input type="text" id="comp-localidad" required aria-required="true">
                        </div>
                        <div class="form-group">
                            <label for="comp-barrio">Barrio/Zona</label>
                            <input type="text" id="comp-barrio" required aria-required="true">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-antiguedad">Antigüedad (años)</label>
                            <input type="number" id="comp-antiguedad" min="0" required aria-required="true">
                        </div>
                        <div class="form-group">
                            <label for="comp-calidad">Calidad de Construcción</label>
                            <select id="comp-calidad" required aria-required="true">
                                <option value="">Seleccionar...</option>
                                <option value="excelente">Excelente</option>
                                <option value="muy-buena">Muy Buena</option>
                                <option value="buena">Buena</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-sup-cubierta">Superficie Cubierta (m²)</label>
                            <input type="number" id="comp-sup-cubierta" min="0" step="0.01" required aria-required="true">
                        </div>
                        <div class="form-group">
                            <label for="comp-sup-terreno">Superficie Total del Terreno (m²)</label>
                            <input type="number" id="comp-sup-terreno" min="0" step="0.01">
                        </div>
                    </div>

                    <!-- CORRECCIÓN 2: Añadir los campos de superficie faltantes al modal -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-sup-semicubierta">Superficie Semicubierta (m²)</label>
                            <input type="number" id="comp-sup-semicubierta" min="0" step="0.01" placeholder="Ej: 20.00">
                        </div>
                        <div class="form-group">
                            <label for="comp-sup-descubierta">Superficie Descubierta (m²)</label>
                            <input type="number" id="comp-sup-descubierta" min="0" step="0.01" placeholder="Ej: 30.00">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-sup-balcon">Superficie Balcón (m²)</label>
                            <input type="number" id="comp-sup-balcon" min="0" step="0.01" placeholder="Ej: 5.00">
                        </div>
                        <div class="form-group">
                            <!-- Espacio para mantener el diseño de 2 columnas -->
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comp-cochera">Cochera</label>
                            <select id="comp-cochera">
                                <option value="no">No tiene</option>
                                <option value="propia">Propia</option>
                                <option value="comun">Común</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="comp-observaciones">Observaciones</label>
                            <textarea id="comp-observaciones" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="btn-cancelar-comparable" class="btn-secondary">Cancelar</button>
                <button type="button" id="btn-guardar-comparable" class="btn-primary">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Contenedor para notificaciones -->
    <div id="notification-container" aria-live="polite"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Contador de visitas -->
    <script>
        // Simple contador de visitas usando localStorage
        document.addEventListener('DOMContentLoaded', () => {
            let visitCount = localStorage.getItem('visitCount') || 0;
            visitCount++;
            localStorage.setItem('visitCount', visitCount);
            console.log(`Visitas: ${visitCount}`);
            
            // Para un contador más robusto, podrías enviar estos datos a un servidor
            // o usar un servicio como Google Analytics
        });
    </script>
    
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script src="js/comparables.js"></script>
    <script src="js/factores.js"></script>
    <script src="js/composicion.js"></script>
    <script src="js/test.js"></script>

    <!-- CONTADOR DE VISITAS EXTERNO -->
    <div id="sfc21ef83zmf33dxcbu6mn2g69kpne5rbls"></div><script type="text/javascript" src="https://counter1.optistats.ovh/private/counter.js?c=21ef83zmf33dxcbu6mn2g69kpne5rbls&down=async" async></script><noscript><a href="https://www.contadorvisitasgratis.com" title="contador de visitas"><img src="https://counter1.optistats.ovh/private/contadorvisitasgratis.php?c=21ef83zmf33dxcbu6mn2g69kpne5rbls" border="0" title="contador de visitas" alt="contador de visitas"></a></noscript>
</body>
</html>

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador Inmobiliario v1.0</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <h1>Cotizador Inmobiliario v1.0</h1>
        <p>Herramienta profesional de tasaci√≥n inmobiliaria</p>
    </header>

    <!-- Indicador de progreso -->
    <div class="progress-indicator">
        <!-- Se generar√° din√°micamente con JavaScript -->
    </div>

    <main>
        <!-- Nivel 1: Datos duros -->
        <section id="datos-duros" class="seccion fade-in">
            <div class="seccion-header">
                <div class="seccion-title">
                    <span class="seccion-icon">üè†</span>
                    <h2>Nivel 1: Datos del Inmueble</h2>
                </div>
                <div class="tooltip">
                    <span class="seccion-icon">‚ùì</span>
                    <span class="tooltip-text">Ingrese los datos objetivos del inmueble a tasar</span>
                </div>
            </div>
            
            <form id="formulario-inmueble">
                <div class="form-row">
                    <div class="form-group">
                        <label for="direccion">Direcci√≥n</label>
                        <input type="text" id="direccion" name="direccion" required>
                        <div class="form-help">Ingrese la direcci√≥n completa del inmueble</div>
                    </div>
                    <div class="form-group">
                        <label for="ubicacion">Ubicaci√≥n</label>
                        <input type="text" id="ubicacion" name="ubicacion" required>
                        <div class="form-help">Barrio o zona</div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="superficie-cubierta">Superficie Cubierta (m¬≤)</label>
                        <input type="number" id="superficie-cubierta" name="superficie-cubierta" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="superficie-semicubierta">Superficie Semicubierta (m¬≤)</label>
                        <input type="number" id="superficie-semicubierta" name="superficie-semicubierta" min="0" step="0.01">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="superficie-descubierta">Superficie Descubierta (m¬≤)</label>
                        <input type="number" id="superficie-descubierta" name="superficie-descubierta" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="superficie-balcon">Superficie Balc√≥n (m¬≤)</label>
                        <input type="number" id="superficie-balcon" name="superficie-balcon" min="0" step="0.01">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="antiguedad">Antig√ºedad (a√±os)</label>
                    <input type="number" id="antiguedad" name="antiguedad" min="0" required>
                </div>
            </form>
        </section>

        <!-- Nivel 2: Comparables -->
        <section id="comparables" class="seccion fade-in">
            <div class="seccion-header">
                <div class="seccion-title">
                    <span class="seccion-icon">üìä</span>
                    <h2>Nivel 2: Comparables de Mercado</h2>
                </div>
                <div class="tooltip">
                    <span class="seccion-icon">‚ùì</span>
                    <span class="tooltip-text">Agregue propiedades similares para comparar</span>
                </div>
            </div>
            
            <div class="acciones">
                <button id="btn-agregar-comparable">Agregar Comparable</button>
            </div>
            
            <div id="comparables-empty" class="state-empty">
                <div class="state-empty-icon">üìã</div>
                <p>No hay comparables cargados</p>
                <p>Haga clic en "Agregar Comparable" para comenzar</p>
            </div>
            
            <div class="table-responsive">
                <table id="tabla-comparables" class="oculto">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Precio Publicado</th>
                            <th>Superficie (m¬≤)</th>
                            <th>Antig√ºedad</th>
                            <th>Direcci√≥n</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Los comparables se agregar√°n din√°micamente -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Nivel 3: Factores de ajuste -->
        <section id="factores-ajuste" class="seccion fade-in">
            <div class="seccion-header">
                <div class="seccion-title">
                    <span class="seccion-icon">‚öñÔ∏è</span>
                    <h2>Nivel 3: Factores de Ajuste</h2>
                </div>
                <div class="tooltip">
                    <span class="seccion-icon">‚ùì</span>
                    <span class="tooltip-text">Ajuste los comparables seg√∫n caracter√≠sticas cualitativas</span>
                </div>
            </div>
            
            <div id="factores-empty" class="state-empty">
                <div class="state-empty-icon">üéØ</div>
                <p>Seleccione un comparable para aplicar factores de ajuste</p>
            </div>
            
            <div id="contenedor-factores" class="oculto">
                <h3>Factores para Comparable #<span id="id-comparable-seleccionado"></span></h3>
                <div class="table-responsive">
                    <table id="tabla-factores">
                        <thead>
                            <tr>
                                <th>Concepto</th>
                                <th>Ponderaci√≥n M√°xima</th>
                                <th>Ajuste Aplicado (%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ubicaci√≥n</td>
                                <td>15%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-15" max="15" step="0.1" value="0" data-factor="ubicacion" data-max="15">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Calidad de construcci√≥n</td>
                                <td>12%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-12" max="12" step="0.1" value="0" data-factor="calidad-construccion" data-max="12">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Expectativa de vida</td>
                                <td>8%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-8" max="8" step="0.1" value="0" data-factor="expectativa-vida" data-max="8">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Estado de mantenimiento</td>
                                <td>15%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-15" max="15" step="0.1" value="0" data-factor="estado-mantenimiento" data-max="15">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Superficie cubierta</td>
                                <td>7%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-7" max="7" step="0.1" value="0" data-factor="superficie-cubierta" data-max="7">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Dimensi√≥n / Sup. descubierta</td>
                                <td>10%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-10" max="10" step="0.1" value="0" data-factor="dimension-descubierta" data-max="10">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Estacionamiento</td>
                                <td>10%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-10" max="10" step="0.1" value="0" data-factor="estacionamiento" data-max="10">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Factibilidad comercial</td>
                                <td>10%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-10" max="10" step="0.1" value="0" data-factor="factibilidad-comercial" data-max="10">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Distribuci√≥n / equipamiento</td>
                                <td>8%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-8" max="8" step="0.1" value="0" data-factor="distribucion-equipamiento" data-max="8">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Orientaci√≥n y vistas</td>
                                <td>5%</td>
                                <td>
                                    <div class="range-container">
                                        <input type="range" min="-5" max="5" step="0.1" value="0" data-factor="orientacion-vistas" data-max="5">
                                        <span class="valor-ajuste">0%</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="acciones">
                    <button id="btn-aplicar-ajustes">Aplicar Ajustes</button>
                </div>
            </div>
        </section>

        <!-- Nivel 4: Precio corregido del comparable -->
        <section id="precio-corregido" class="seccion fade-in">
            <div class="seccion-header">
                <div class="seccion-title">
                    <span class="seccion-icon">üí∞</span>
                    <h2>Nivel 4: Precio Corregido de Comparables</h2>
                </div>
                <div class="tooltip">
                    <span class="seccion-icon">‚ùì</span>
                    <span class="tooltip-text">Precios de los comparables despu√©s de aplicar los ajustes</span>
                </div>
            </div>
            
            <div id="precios-corregidos-empty" class="state-empty">
                <div class="state-empty-icon">üìà</div>
                <p>Aplique ajustes a los comparables para ver los precios corregidos</p>
            </div>
            
            <div class="table-responsive">
                <table id="tabla-precios-corregidos" class="oculto">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Precio Original</th>
                            <th>Correcci√≥n Total (%)</th>
                            <th>Precio Corregido</th>
                            <th>Valor por m¬≤</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Los precios corregidos se agregar√°n din√°micamente -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Nivel 5: Valor m¬≤ de referencia -->
        <section id="valor-m2-referencia" class="seccion fade-in">
            <div class="seccion-header">
                <div class="seccion-title">
                    <span class="seccion-icon">üìê</span>
                    <h2>Nivel 5: Valor por m¬≤ de Referencia</h2>
                </div>
                <div class="tooltip">
                    <span class="seccion-icon">‚ùì</span>
                    <span class="tooltip-text">Valor por metro cuadrado calculado a partir de los comparables</span>
                </div>
            </div>
            
            <div class="result-card">
                <div class="metodo-calculo">
                    <label for="metodo-referencia">M√©todo de C√°lculo:</label>
                    <select id="metodo-referencia">
                        <option value="promedio">Promedio</option>
                        <option value="mediana">Mediana</option>
                        <option value="rango">Rango (Promedio del rango intermedio)</option>
                    </select>
                </div>
                <div class="resultado-referencia">
                    <div class="result-title">Valor por m¬≤ de referencia</div>
                    <div class="result-value">$<span id="valor-m2">0.00</span></div>
                </div>
            </div>
        </section>

        <!-- Nivel 6: Composici√≥n del valor del inmueble -->
        <section id="composicion-valor" class="seccion fade-in">
            <div class="seccion-header">
                <div class="seccion-title">
                    <span class="seccion-icon">üèóÔ∏è</span>
                    <h2>Nivel 6: Composici√≥n del Valor del Inmueble</h2>
                </div>
                <div class="tooltip">
                    <span class="seccion-icon">‚ùì</span>
                    <span class="tooltip-text">Valor total del inmueble seg√∫n composici√≥n de superficies</span>
                </div>
            </div>
            
            <div class="result-card">
                <div class="table-responsive">
                    <table id="tabla-composicion">
                        <thead>
                            <tr>
                                <th>Tipo de Superficie</th>
                                <th>Superficie (m¬≤)</th>
                                <th>Coeficiente</th>
                                <th>Valor Parcial</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Cubierta</td>
                                <td id="m2-cubierta">0</td>
                                <td>100%</td>
                                <td id="valor-cubierta">$0.00</td>
                            </tr>
                            <tr>
                                <td>Semicubierta</td>
                                <td id="m2-semicubierta">0</td>
                                <td>50%</td>
                                <td id="valor-semicubierta">$0.00</td>
                            </tr>
                            <tr>
                                <td>Descubierta</td>
                                <td id="m2-descubierta">0</td>
                                <td>20%</td>
                                <td id="valor-descubierta">$0.00</td>
                            </tr>
                            <tr>
                                <td>Balc√≥n</td>
                                <td id="m2-balcon">0</td>
                                <td>33%</td>
                                <td id="valor-balcon">$0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="valor-total">
                    <h3>TOTAL VALOR DE TASACI√ìN</h3>
                    <div>$<span id="valor-total">0.00</span></div>
                </div>
            </div>
        </section>

        <!-- Acciones generales -->
        <section id="acciones-generales" class="seccion fade-in">
            <div class="acciones">
                <button id="btn-calcular-todo">Calcular Tasaci√≥n Completa</button>
                <button id="btn-reiniciar" class="secondary">Reiniciar C√°lculo</button>
                <button id="btn-exportar" class="secondary">Exportar Datos</button>
            </div>
        </section>
    </main>

    <footer>
        <p>Cotizador Inmobiliario v1.0 - Documentaci√≥n T√©cnica</p>
    </footer>

    <!-- Modal para agregar/editar comparables -->
    <div id="modal-comparable" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modal-titulo">Agregar Comparable</h2>
            <form id="form-comparable">
                <input type="hidden" id="modal-id">
                <div class="form-group">
                    <label for="modal-precio">Precio Publicado</label>
                    <input type="number" id="modal-precio" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="modal-superficie">Superficie (m¬≤)</label>
                    <input type="number" id="modal-superficie" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="modal-antiguedad">Antig√ºedad (a√±os)</label>
                    <input type="number" id="modal-antiguedad" min="0" required>
                </div>
                <div class="form-group">
                    <label for="modal-direccion">Direcci√≥n</label>
                    <input type="text" id="modal-direccion" required>
                </div>
                <div class="acciones">
                    <button type="button" id="btn-guardar-comparable">Guardar</button>
                    <button type="button" class="secondary" onclick="document.getElementById('modal-comparable').style.display='none'">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Contenedor para mensajes de error -->
    <div id="error-container" class="error-container" style="display: none;">
        <h3>Errores de validaci√≥n</h3>
        <ul id="error-list"></ul>
        <button id="btn-cerrar-errores">Cerrar</button>
    </div>

    <script src="js/comparables.js"></script>
    <script src="js/composicion.js"></script>
    <script src="js/asesor.js"></script>
    <script src="js/test.js"></script>
</body>
</html>
